----------------------------------------------------------------------
README
(/SPECFEM3D/examples/meshfem3D_examples/socal1D/README)
----------------------------------------------------------------------

This is a very simple example to explain the use of the internal mesher meshfem3D.
The example uses the standard 1D model used in southern California (SoCal-1D).

Option 1: run process.sh from local directory (must have access to mpi)
Option 2: follow instructions below for submitting separate jobs with qsub (or bsub)

----------------------------------------------------------------------

0. Run the default homogeneous halfspace example (external mesh).

1. Set up input files.

   > cd SPECFEM3D
   > rsync -av examples/meshfem3D_examples/socal1D/ in_data_files/meshfem3D_files/

   > cd in_data_files/meshfem3D_files/
   > cp Par_file CMTSOLUTION STATIONS ..
   > cd SPECFEM3D

   - adapt the submission scripts for the appropriate queues and number of cores:
     go_mesher_pbs.bash, go_generate_databases_pbs.bash, go_solver_pbs.bash

   - note: go_decomposer_pbs.bash is not used with the internal mesher

2. compile and run internal mesher 

   > make xmeshfem3D

   > qsub go_mesher_pbs.bash

   This should generate these files in in_out_files/DATABASES_MPI/:

   proc000000_Database
   proc000000_.dx
   proc000000_.INP

   - save output file
   > cp in_out_files/OUTPUT_FILES/output_mesher.txt in_out_files/OUTPUT_FILES/output_meshfem3D.txt

3. generate databases:

   - compile generate_databases in directory SPECFEM3D/:
     > make xgenerate_databases

   - submit job script:
     > qsub go_generate_databases_pbs.bash

     this will create binary mesh files, e.g. "proc000***_external_mesh.bin"
     in directory in_out_files/DATABASES_MPI/.

     Optional: If you have paraview, load the .vtk files (see socal1D_sesame.png).

4. run simulation:

   - compile specfem3D:
     > make xspecfem3D

   - submit job script:
     > qsub go_solver_pbs.bash

   - the job should take about 5 minutes
   - when the job is complete, you should have 3 sets (semd,semv,sema)
     of 84 (ls -1 *semd | wc) seismogram files in the directory in_out_files/OUTPUT_FILES,
     as well as 9 timestamp****** files

   - view seismograms, for example, using xmgrace:
   - xmgrace WTT*.semd &

----------------------------------------------------------------------
