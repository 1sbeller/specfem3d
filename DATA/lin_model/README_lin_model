Carl Tape, 02-August-2007, 02-June-2010
Tomography model of Lin-Shearer-Hauksson-Thurber (JGR 2007).

As of June 2010, the Lin-2007 model is the default backgrodun tomographic model for the southern California simulations. This model replaces the Hauksson-2000 model, which can be implemented with minor modifications -- see DATA/hauksson_model/README_hauksson_model for details.

-----------------------------------
IMPLEMENTING THE LIN MODEL FOR SPECFEM3D
-----------------------------------

This procedure is adapted from the files in DATA/hauksson_model/

1. The original model files from Egill Hauksson are in lin_2007/
2. The file lin_new_format.dat is created in hauksson_tomo_model.m,
   which requires additional Matlab scripts to run.
3. runall.csh contains three command that densify the grid to
   create lin_final_grid_smooth.dat, which is read into SPECFEM3D.

-----------------------------------
COMPARISONS BETWEEN HAUKSSON-2000 and LIN-2007 MODELS
-----------------------------------

See lin_2007/README for details on the tomographic model.

hauk-lin.pdf shows some subtle differences between the Hauksson (2000) model and the Lin et al. (2007) model.

new_bounds.pdf shows the nodes for the Lin model.
red dashed   -- 'standard' simulation domain
red solid    -- Hauksson interpolated regular grid domain
black dashed -- 'new' simulation domain (extended west)
black solid  -- new Hauksson interpolated regular grid domain

-----------------------------------
CHANGES TO RUN IN SPECFEM3D
-----------------------------------

First, in create_regions_mesh.f90, you need to uncomment the call to the
Lin et al. (2007) model and comment the call to the Hauksson (2000) model.

!    call get_value_string(HAUKSSON_REGIONAL_MODEL_FILE, &
!                          'model.HAUKSSON_REGIONAL_MODEL_FILE', &
!                          'DATA/hauksson_model/hauksson_final_grid_smooth.dat')
    call get_value_string(HAUKSSON_REGIONAL_MODEL_FILE, &
                          'model.HAUKSSON_REGIONAL_MODEL_FILE', &
                          'DATA/lin_model/lin_final_grid_smooth.dat')

Second, the parameters in constants.h need to be adjusted to reflect the slightly different parameterization used in the Lin model versus the Hauksson model. I have left the pertinent lines in SPECFEM3D/DATA/lin_model/constants.h; basically you need to comment the Hauksson model lines and un-comment the Lin model lines.

Third, by having one less layer in the Lin model, I needed to make minor adjustments to hauksson_model.f90, which I have copied to SPECFEM3D/DATA/lin_model/hauksson_model.f90

Fourth, make sure the extended region is specified in the Par_file, which I have copied to
SPECFEM3D/DATA/lin_model/Par_file

LONGITUDE_MIN                   = -121.6d0   ! -120.3d0
NEX_XI                          = 336
NEX_ETA                         = 288
NPROC_XI                        = 14
NPROC_ETA                       = 12

-----------------------------------

In the future, we can decide how to commit these changes.  For example, perhaps having
a LIN_MODEL option would be sensible, or eliminating the Hauksson model altogether,
since this is presubaly an updated version of his model.

=======================================================